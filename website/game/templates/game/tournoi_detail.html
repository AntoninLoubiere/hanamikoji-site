{% extends 'base_game.html' %}
{% block title %}Tournoi n°{{ tournoi.id_tournoi }}{% endblock title %}

{% block content %}
<h1>Tournoi n°{{ tournoi.id_tournoi }}</h1>
<div class="content-section">
    <span class="content-center">{{ tournoi.get_status_display }}</span>
    {% if tournoi.status != 'EA' %}
    <span class="content-center">Lancement : {{ tournoi.date_lancement }}</span>
    {% endif %}
    {% if tournoi.status == 'LP' or tournoi.status == 'EA' %}
    Choix des champions <br />
    <form method="post" class="form">
        {{ form.as_p }}
        {% csrf_token %}
        <button type="submit" id="envoi">Envoyer</button>
    </form>
    {% elif tournoi.status == 'EC' %}
    Nombres de matchs terminés : {{ termine }} sur {{ nb_matchs }}
    {% elif tournoi.status == 'FI' %}
    <table>
        <caption>Classement</caption>
        <tr>
            <th>Classement</th>
            <th>Nom</th>
            <th>Auteur</th>
            <th>Nombre de points</th>
        </tr>
        {% for ins in inscrits %}
        <tr>
            <td>{{ ins.classement }}</td>
            <td title="{{ins.champion}}">{{ ins.champion.nom }}</td>
            <td id="sans_casse">{{ ins.champion.uploader }}</td>
            <td>{{ ins.nb_points }}</td>
        </tr>
        {% endfor %}
    </table>

    <table>
        <caption>Matchs</caption>
        <tr>
            <th>Champions</th>
            {% for i, _ in match_matrix %}
                <th title="{{ i.champion }}">{{ i.champion.nom }}</th>
            {% endfor %}
        </tr>
        {% for i, ms in match_matrix %}
            <tr>
                <th title="{{ i.champion }}">{{ i.champion.nom }}</th>
                {% for m in ms %}
                {% if m %}
                    <td class="match {% if m.gagnant == 1 %} match-won {% elif m.gagnant == 2 %} match-lost {% else %} match-egalite {% endif %}">
                        <a href="{% url 'match_detail' m.id_match %}">{{ m.score1 }} à {{ m.score2 }}</a>
                    </td>
                    {% else %}
                        <td class="match-inexistant"></td>
                    {% endif %}
                {% endfor %}
            </tr>
        {% endfor %}
    </table>


    {% endif %}
    {% if tournoi.status == 'LP' and user.create_tournament or tournoi.status == 'EA' and user.create_tournament %}
    {# J'ai pas trouvé mieux #}
    <a href="{% url 'update_tournoi' tournoi.id_tournoi %}" class="content-center">Lancer ou changer la date du
        tournoi</a>
    {% endif %}
</div>
{% endblock content %}